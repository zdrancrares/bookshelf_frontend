{"version":3,"file":"index.mjs","sources":["../../src/keyfilter/BaseKeyFilter.js","../../src/keyfilter/KeyFilter.js"],"sourcesContent":["import BaseDirective from '@primevue/core/basedirective';\nimport KeyFilterStyle from 'primevue/keyfilter/style';\n\nconst BaseKeyFilter = BaseDirective.extend({\n    style: KeyFilterStyle\n});\n\nexport default BaseKeyFilter;\n","import { isAttributeEquals } from '@primeuix/utils/dom';\nimport BaseKeyFilter from './BaseKeyFilter';\n\nconst KeyFilter = BaseKeyFilter.extend('keyfilter', {\n    beforeMount(el, options) {\n        let target = this.getTarget(el);\n\n        if (!target) return;\n\n        target.$_pkeyfilterModifier = this.getModifiers(options);\n\n        if (options.value !== undefined) {\n            target.$_pkeyfilterPattern = options.value?.pattern || options.value;\n            target.$_pkeyfilterValidateOnly = options.value?.validateOnly || false;\n        }\n\n        this.bindEvents(target);\n\n        target.setAttribute('data-pd-keyfilter', true);\n    },\n    updated(el, options) {\n        let target = this.getTarget(el);\n\n        if (!target) return;\n\n        target.$_pkeyfilterModifier = this.getModifiers(options);\n        this.unbindEvents(el, options);\n\n        if (options.value !== undefined) {\n            target.$_pkeyfilterPattern = options.value?.pattern || options.value;\n            target.$_pkeyfilterValidateOnly = options.value?.validateOnly || false;\n        }\n\n        this.bindEvents(target);\n    },\n    unmounted(el, options) {\n        this.unbindEvents(el, options);\n    },\n    DEFAULT_PATTERNS: {\n        pint: /[\\d]/,\n        int: /[\\d-]/,\n        pnum: /[\\d.]/,\n        money: /[\\d.\\s,]/,\n        num: /[\\d-.]/,\n        hex: /[0-9a-f]/i,\n        email: /[a-z0-9_.-@]/i,\n        alpha: /[a-z_]/i,\n        alphanum: /[a-z0-9_]/\n    },\n    methods: {\n        getTarget(el) {\n            return isAttributeEquals(el, 'data-pc-name', 'inputtext') || isAttributeEquals(el, 'data-pc-name', 'textarea') ? el : null;\n        },\n        getModifiers(options) {\n            if (options.modifiers && Object.keys(options.modifiers).length) {\n                return Object.keys(options.modifiers)[Object.keys(options.modifiers).length - 1];\n            }\n\n            return '';\n        },\n        getRegex(target) {\n            return target.$_pkeyfilterPattern ? target.$_pkeyfilterPattern : target.$_pkeyfilterModifier ? this.DEFAULT_PATTERNS[target.$_pkeyfilterModifier] : /./;\n        },\n        bindEvents(el) {\n            el.$_keyfilterKeydownEvent = (event) => this.onKeydown(event, el);\n            el.$_keyfilterPasteEvent = (event) => this.onPaste(event, el);\n            el.$_keyfilterInputEvent = (event) => this.onInput(event, el);\n\n            el.addEventListener('keypress', el.$_keyfilterKeydownEvent);\n            el.addEventListener('paste', el.$_keyfilterPasteEvent);\n            el.addEventListener('input', el.$_keyfilterInputEvent);\n        },\n        unbindEvents(el) {\n            el.removeEventListener('keypress', el.$_keyfilterKeydownEvent);\n            el.removeEventListener('paste', el.$_keyfilterPasteEvent);\n            el.removeEventListener('input', el.$_keyfilterInputEvent);\n\n            el.$_keyfilterKeydownEvent = null;\n            el.$_keyfilterPasteEvent = null;\n            el.$_keyfilterInputEvent = null;\n        },\n        onInput(event, target) {\n            const regex = this.getRegex(target);\n\n            if (regex && !regex.test(target.value)) {\n                // remove invalid character e.g. ~ \"\n                target.value = target.value.slice(0, -1);\n            }\n        },\n        onKeydown(event, target) {\n            if (event.ctrlKey || event.altKey || event.metaKey || event.key === 'Tab') {\n                return;\n            }\n\n            let regex = this.getRegex(target);\n\n            if (regex === '') {\n                return;\n            }\n\n            let testKey = `${event.key}`;\n\n            if (target.$_pkeyfilterValidateOnly) {\n                testKey = `${target.value.substring(0, target.selectionStart)}${event.key}${target.value.substring(target.selectionEnd)}`;\n            }\n\n            if (!regex.test(testKey)) {\n                // runs before @update:modelValue emit\n                event.preventDefault();\n            }\n        },\n        onPaste(event, target) {\n            let regex = this.getRegex(target);\n\n            if (regex === '') {\n                return;\n            }\n\n            const clipboard = event.clipboardData.getData('text');\n\n            if (target.$_pkeyfilterValidateOnly) {\n                const newValue = `${target.value.substring(0, target.selectionStart)}${clipboard}${target.value.substring(target.selectionEnd)}`;\n\n                if (!regex.test(newValue)) {\n                    event.preventDefault();\n                }\n            } else {\n                for (let i = 0; i < clipboard.length; i++) {\n                    if (!regex.test(clipboard[i])) {\n                        event.preventDefault();\n\n                        return;\n                    }\n                }\n            }\n        }\n    }\n});\n\nexport default KeyFilter;\n"],"names":["BaseKeyFilter","BaseDirective","extend","style","KeyFilterStyle","KeyFilter","beforeMount","el","options","target","getTarget","$_pkeyfilterModifier","getModifiers","value","undefined","_options$value","_options$value2","$_pkeyfilterPattern","pattern","$_pkeyfilterValidateOnly","validateOnly","bindEvents","setAttribute","updated","unbindEvents","_options$value3","_options$value4","unmounted","DEFAULT_PATTERNS","pint","pnum","money","num","hex","email","alpha","alphanum","methods","isAttributeEquals","modifiers","Object","keys","length","getRegex","_this","$_keyfilterKeydownEvent","event","onKeydown","$_keyfilterPasteEvent","onPaste","$_keyfilterInputEvent","onInput","addEventListener","removeEventListener","regex","test","slice","ctrlKey","altKey","metaKey","key","testKey","concat","substring","selectionStart","selectionEnd","preventDefault","clipboard","clipboardData","getData","newValue","i"],"mappings":"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"}